<!doctype html><html class="theme-next pisces"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="YtIwelKWFVHPXmIvYL-XxbDiILIPD0B7CKo16OVMYsM"><link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css"><meta name="keywords" content="pssac,GMT,教程,"><link rel="alternate" href="/atom.xml" title="SeisMan" type="application/atom+xml"><meta name="description" content="注意：本文仅针对 Prof. Lupei Zhu 的 pssac 程序，其仅可在 GMT 4下使用。 对于GMT5用户，GMT 在 5.3.1 之后自带了 pssac，可以使用 gmt pssac 直接调用。 相关文档见:  http://gmt.soest.hawaii.edu/doc/latest/supplements/meca/pssac.html http://modules.gmt-c"><meta name="keywords" content="pssac,GMT,教程"><meta property="og:type" content="article"><meta property="og:title" content="pssac 使用教程"><meta property="og:url" content="http://seisman.info/pssac-notes.html"><meta property="og:site_name" content="SeisMan"><meta property="og:description" content="注意：本文仅针对 Prof. Lupei Zhu 的 pssac 程序，其仅可在 GMT 4下使用。 对于GMT5用户，GMT 在 5.3.1 之后自带了 pssac，可以使用 gmt pssac 直接调用。 相关文档见:  http://gmt.soest.hawaii.edu/doc/latest/supplements/meca/pssac.html http://modules.gmt-c"><meta property="og:image" content="http://seisman.info/images/2015071701.png"><meta property="og:image" content="http://seisman.info/images/2015071702.png"><meta property="og:image" content="http://seisman.info/images/2015071703.png"><meta property="og:image" content="http://seisman.info/images/2015071704.png"><meta property="og:image" content="http://seisman.info/images/2015071705.png"><meta property="og:image" content="http://seisman.info/images/2015071706.png"><meta property="og:image" content="http://seisman.info/images/2015071707.png"><meta property="og:image" content="http://seisman.info/images/2015071708.png"><meta property="og:image" content="http://seisman.info/images/2015071709.png"><meta property="og:image" content="http://seisman.info/images/2015071710.png"><meta property="og:image" content="http://seisman.info/images/2015071711.png"><meta property="og:image" content="http://seisman.info/images/2015071712.png"><meta property="og:image" content="http://seisman.info/images/2015071713.png"><meta property="og:image" content="http://seisman.info/images/2015071714.png"><meta property="og:image" content="http://seisman.info/images/2015071715.png"><meta property="og:updated_time" content="2017-04-28T04:44:34.318Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="pssac 使用教程"><meta name="twitter:description" content="注意：本文仅针对 Prof. Lupei Zhu 的 pssac 程序，其仅可在 GMT 4下使用。 对于GMT5用户，GMT 在 5.3.1 之后自带了 pssac，可以使用 gmt pssac 直接调用。 相关文档见:  http://gmt.soest.hawaii.edu/doc/latest/supplements/meca/pssac.html http://modules.gmt-c"><meta name="twitter:image" content="http://seisman.info/images/2015071701.png"><script type="text/javascript" id="hexo.configuration">var NexT=window.NexT||{},CONFIG={scheme:"Pisces",sidebar:{position:"left",display:"post"},fancybox:!0,motion:!1,duoshuo:{userId:0,author:"博主"}}</script><link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-57x57.png?v=2.0"><link rel="apple-touch-icon" sizes="60x60" href="/images/apple-touch-icon-60x60.png?v=2.0"><link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png?v=2.0"><link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png?v=2.0"><link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png?v=2.0"><link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.png?v=2.0"><link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144x144.png?v=2.0"><link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png?v=2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-180x180.png?v=2.0"><link rel="icon" type="image/png" href="/images/favicon-32x32.png?v=2.0" sizes="32x32"><link rel="icon" type="image/png" href="/images/android-chrome-192x192.png?v=2.0" sizes="192x192"><link rel="icon" type="image/png" href="/images/favicon-96x96.png?v=2.0" sizes="96x96"><link rel="icon" type="image/png" href="/images/favicon-16x16.png?v=2.0" sizes="16x16"><link rel="manifest" href="/images/manifest.json?v=2.0"><link rel="mask-icon" href="/images/safari-pinned-tab.svg?v=2.0" color="#5bbad5"><link rel="shortcut icon" href="/images/favicon.ico?v=2.0"><meta name="apple-mobile-web-app-title" content="SeisMan"><meta name="application-name" content="SeisMan"><meta name="msapplication-TileColor" content="#9f00a7"><meta name="msapplication-TileImage" content="/images/mstile-144x144.png?v=2.0"><meta name="msapplication-config" content="/images/browserconfig.xml?v=2.0"><meta name="theme-color" content="#ffffff"><title> pssac 使用教程 | SeisMan</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">SeisMan</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">学会整理自己的经验是科研的第一步。</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-collections"><a href="/collections.html" rel="section"><i class="menu-item-icon fa fa-fw fa-book"></i><br> 合集</a></li><li class="menu-item menu-item-links"><a href="/links.html" rel="section"><i class="menu-item-icon fa fa-fw fa-link"></i><br> 链接</a></li><li class="menu-item menu-item-donations"><a href="/donations.html" rel="section"><i class="menu-item-icon fa fa-fw fa-rmb"></i><br> 捐赠</a></li><li class="menu-item menu-item-about"><a href="/about.html" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-search"><a href="#" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup"><span class="search-icon fa fa-search"></span> <input type="text" id="local-search-input"><div id="local-search-result"></div> <span class="popup-btn-close">close</span></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"> pssac 使用教程</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2015-07-16T16:00:00+00:00" content="2015-07-17">2015-07-17</time></span> <span class="post-category">&nbsp; | &nbsp;<span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/地震学软件/" itemprop="url" rel="index"><span itemprop="name">地震学软件</span></a></span></span> <span class="post-comments-count">&nbsp; | &nbsp;<a href="/pssac-notes.html#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="pssac-notes.html" itemprop="commentsCount"></span></a></span> &nbsp; | &nbsp;<span class="viewraw-icons"><a href="https://github.com/seisman/seisman.info.posts/raw/master/_posts/2015-07-17-pssac-notes.md" title="查看源代码" target="_blank"><i class="fa fa-file-text-o"></i></a></span><span class="viewraw-icons"><a href="https://github.com/seisman/seisman.info.posts/commits/master/_posts/2015-07-17-pssac-notes.md" title="查看修改历史" target="_blank"><i class="fa fa-history"></i></a></span><span class="viewraw-icons"><a href="//o7sbpc9b9.qnssl.com/pdfs/2015-07-17-pssac-notes.pdf" title="下载PDF" target="_blank"><i class="fa fa-file-pdf-o"></i></a></span><div class="post-tags"> <a href="/tags/pssac/" rel="tag">#pssac</a> <a href="/tags/GMT/" rel="tag">#GMT</a> <a href="/tags/教程/" rel="tag">#教程</a></div></div></header><div class="post-body" itemprop="articleBody"><p><strong>注意：本文仅针对 Prof. Lupei Zhu 的 pssac 程序，其仅可在 GMT 4下使用。 对于GMT5用户，GMT 在 5.3.1 之后自带了 pssac，可以使用 <code>gmt pssac</code> 直接调用。</strong></p><p>相关文档见:</p><ul><li>http://gmt.soest.hawaii.edu/doc/latest/supplements/meca/pssac.html</li><li>http://modules.gmt-china.org/pssac.html</li></ul><p><code>pssac</code> 可以读取 SAC 波形数据，并利用 GMT 的绘图功能将波形数据绘制在 PS 文件中。 <code>pssac</code> 绘制的波形图，大致可以分为三类：</p><ol style="list-style-type:decimal"><li>波形振幅图：横轴是时间，纵轴是振幅；</li><li>剖面图：横轴是时间，纵轴是其他物理量（比如震中距、方位角、反方位角以及文件号）；</li><li>任意位置图：将波形文件绘制在图上的任意位置；</li></ol><p>本文首先简单介绍 <code>pssac</code> 的各个选项，然后依次介绍如何绘制波形振幅图、剖面图以及任意位置图，在这个过程中会详细介绍较复杂的选项。</p><a id="more"></a><h2 id="选项一览">选项一览</h2><p>终端输入 <code>pssac</code> 即可得到 pssac 的使用说明。pssac 的命令中主要包含了三个部分：</p><ol style="list-style-type:decimal"><li>GMT 的标准选项</li><li>pssac 的特有选项</li><li>SAC 文件</li></ol><h3 id="gmt-标准选项">GMT 标准选项</h3><p>pssac 继承了 GMT 的众多标准选项，包括：</p><ol style="list-style-type:decimal"><li>必须选项： <code>-J -R</code></li><li>可选选项： <code>-B -K -O -U -X -Y -W</code></li></ol><p>这些选项的具体用法可以参考 GMT 官方文档，简单说明如下：</p><ul><li><code>-J</code> ：设置投影方式以及底图尺寸；</li><li><code>-R</code> ：设置横纵坐标的范围；</li><li><code>-B</code> ：设置底图边框的属性；</li><li><code>-K -O</code> ：图层叠加；</li><li><code>-U</code> ：Unix 时间戳；</li><li><code>-X -Y</code> ：移动绘图原点；</li><li><code>-W</code> ：用于设置线条的粗细、颜色与线型；</li></ul><p>需要注意： <code>pssac</code> 不支持 <code>-P</code> 选项。</p><h3 id="pssac-特有选项">pssac 特有选项</h3><p><code>pssac</code> 的特有选项有:</p><pre><code>-C -E -G -I -M -N -Q -r -S -V</code></pre><p>先简单介绍一个这些选项的作用：</p><ul><li><code>-I</code> ：绘图之前先对波形做积分；代码中在做积分时，没有乘以采样间隔，因而导致波形的绝对振幅有误，但波形的形状是正确的；</li><li><code>-Q</code> ：绘图之前先对波形做平方；</li><li><code>-r</code> ：绘图之前先去除均值；该选项仅在同时使用 <code>-M</code> 选项时有效；</li><li><code>-Nclip</code> ：使用该选项会使得波形振幅限制在 <code>[-clip, clip]</code> 范围内；若波形数据中某数据点的振幅值大于 clip，则该数据点会被赋值为 clip；若某数据点的振幅值小于 - clip，则该数据点会被赋值为 - clip；该选项仅在同时使用 <code>-M</code> 选项时有效；</li><li><code>-Gr/g/b/c</code> ：将振幅大于 <code>c</code> 的部分填色，颜色由 <code>r/g/b</code> 决定；此处只支持 RGB 颜色；不支持颜色名、HSV 等；</li><li><code>-Ct1/t2</code> ：只截取波形中 t1 到 t2 时间段内的数据；若只使用 <code>-C</code> 而不给出 t1 和 t2，则会根据 <code>-R</code> 选项指定的 X 轴范围对数据做截取；</li><li><code>-Msize/alpha</code> ：将波形数据振幅归一化到某个尺寸；</li><li><code>-Sshift</code> ：将波形数据整体移动 shift 秒，相当于 <code>b=b+shift</code> ；</li><li><code>-E</code> ：设置剖面图的 Y 轴类型，以及数据的时间对齐方式；</li><li><code>-V</code> ：垂直绘制波形，即交换 X 轴和 Y 轴；</li></ul><p>不同的选项对数据做了不同的处理，这就涉及到数据处理的顺序问题。前面的处理会影响到后面的处理，因而也会影响到其他选项的参数的选取。pssac 中波形的处理顺序，或者说不同选项之间的优先级：</p><ol style="list-style-type:decimal"><li><p>先处理 X 轴:</p><pre><code>波形对齐 (-E) =&gt; 波形整体 shift(-S) =&gt; 截窗 (-C)</code></pre></li><li><p>再处理 Y 轴，即波形发生了变化:</p><pre><code>积分 (-I) =&gt; 平方(-Q) =&gt; 去均值(-r) =&gt; 振幅归“一” 化(-M) =&gt; 限幅处理(-N)</code></pre></li><li>交换 X 轴和 Y 轴（-V）</li><li><p>绘制波形:</p><pre><code>绘制波形 (-W) =&gt; 填色 (-G)</code></pre></li></ol><h2 id="波形振幅图">波形振幅图</h2><p>这一节会介绍如何用 pssac 绘制最简单的波形振幅图，在介绍的同时会尽可能详细地解释每个选项的意义。在绘制简单的波形振幅图时不需要使用 <code>-E</code> 选项，所以 <code>-E</code> 选项的介绍放在绘制剖面图时再介绍。</p><h3 id="示例-sac-数据">示例 SAC 数据</h3><p>先用 SAC 生成两个示例数据，以方便重复下面的绘图:</p><pre><code>SAC&gt; fg seis
SAC&gt; rmean
SAC&gt; ch t0 12   // 做了 t0 标记，供后面使用
SAC&gt; w seis.1
SAC&gt; mul 2      // 将数据整体乘以 2，写到新文件中
SAC&gt; w seis.2</code></pre><p>用 <code>saclst</code> 查看一下两个数据的头段信息:</p><pre><code>$ saclst b e t0 depmax depmin f seis.?
seis.1         9.46       19.45          12     1.61919    -1.47073
seis.2         9.46       19.45          12     3.23837    -2.94147</code></pre><h3 id="单个波形的振幅">单个波形的振幅</h3><p>先以 <code>seis.1</code> 为例，根据头段信息可知，该数据的时间范围为 <code>[9.46,19.45]</code>， 振幅范围为 <code>[-1.47,1.62]</code> 。据此，可以设置 - R 选项的参数为 <code>-R9/20/-2/2</code> :</p><pre><code>pssac -JX20c/10c -R9/20/-2/2 seis.1 &gt; test.ps</code></pre><div class="figure"> <img src="/images/2015071701.png"></div><p>上面的例子中只使用了 - J 和 - R 选项，是 pssac 的最小示例。通常情况下，还需要使用 - B 选项给波形图加上边框:</p><pre><code>pssac -JX20c/10c -R9/20/-2/2 -B1:&quot;T(s)&quot;:/0.5:&quot;Amplitude&quot;:WSen seis.1 &gt; test.ps</code></pre><div class="figure"> <img src="/images/2015071702.png"></div><p>加上边框之后就很清楚了，横轴表示时间，纵轴表示波形的绝对振幅。</p><h3 id="绘制多个波形">绘制多个波形</h3><p>绘制一个波形是不够的，pssac 还可以一次性绘制多个波形:</p><pre><code>pssac -JX25c/5c -R10/16/-3.2/3.2 -B1:&quot;T(s)&quot;:/1:&quot;Amplitude&quot;:WSen seis.? &gt; test.ps</code></pre><p>这个例子中，同时绘制了 seis.1 和 seis.2 两个波形，为了看上去更明显，这里使用了稍稍不同的 - J 和 - R。可以看到 seis.2 和 seis.1 共用了 X 轴和 Y 轴，跟 SAC 中的 <code>plot2</code> 命令的效果相同。</p><div class="figure"> <img src="/images/2015071703.png"></div><h3 id="s-选项的效果">-S 选项的效果</h3><p><code>-S</code> 选项相当于将数据的 b 值加上了 <code>shift</code> 秒，因而会影响到 X 轴的范围，即影响到 - R 选项的参数:</p><pre><code>pssac -JX20c/10c -R29/40/-2/2 -B1:&quot;T(s)&quot;:/0.5:&quot;Amplitude&quot;:WSen -S20 seis.1 &gt; test.ps</code></pre><p>上面的代码中使用了 <code>-S20</code> ，将波形整体移动了 20 秒，此时移动后的波形 <code>b=29.46, e=39.45</code> ，因而 <code>-R</code> 选项也要相应的变化。</p><div class="figure"> <img src="/images/2015071704.png"></div><h3 id="c-选项的效果">-C 选项的效果</h3><p><code>-C</code> 选项的作用在于从当前数据中截取其中一段，这样可以只显示一个长波形中的一小段:</p><pre><code>pssac -JX20c/10c -R9/20/-2/2 -B1:&quot;T(s)&quot;:/0.5:&quot;Amplitude&quot;:WSen -C11/14 seis.1 &gt; test.ps</code></pre><p>本例中，数据的时间范围是 <code>[9.46, 19.45]</code>， <code>-C</code> 选项截取了其中的 11 到 14 秒，用于绘图，效果图如下，注意与图 2 对比。</p><div class="figure"> <img src="/images/2015071705.png"></div><p>由于 <code>-S</code> 选项优先于 <code>-C</code> 选项，因而使用 <code>-S</code> 选项会对 <code>-R</code> 和 <code>-C</code> 的参数同时产生影响:</p><pre><code>pssac -JX20c/10c -R29/40/-2/2 -B1:&quot;T(s)&quot;:/0.5:&quot;Amplitude&quot;:WSen seis.1 -S20 -C31/34 &gt; test.ps</code></pre><div class="figure"> <img src="/images/2015071706.png"></div><p>本例中，同时使用了 <code>-S</code> 和 <code>-C</code> ，由于 <code>-S</code> 优先于 <code>-C</code>，所以波形数据的时间范围首先被 <code>-S20</code> 选项从 <code>[9.46, 19.45]</code> 移动到 <code>[29.46, 39.45]</code> ，而 <code>-C31/34</code> 则截取了偏移后的波形数据的 31 到 34 秒，相当于截取偏移之前数据的 11 到 14 秒。</p><h3 id="i--q--r">-I, -Q, -r</h3><p>三个选项分别实现波形的积分、平方和去均值，加上这些选项后会影响波形的振幅，因而需要调整 - R 中 Y 轴的范围。另外需要注意的是，<code>-C</code> 选项的优先级要高于这三个选项，因而若同时使用了 <code>-C</code> 选项，则只会对截取的这一段数据做积分 / 平方 / 去均值的操作。这几个选项相对简单，且不常用，暂且不多说。</p><h3 id="m-选项">-M 选项</h3><p><code>-M</code> 选项会对波形进行 “归一化”，只是这里的“归一化” 并不真的代表将振幅归一化到 1。</p><p><code>-M</code> 选项的语法为 <code>-Msize[/alpha]</code>，依据参数的不同可以进一步分为三种用法。</p><ol style="list-style-type:decimal"><li><code>-Msize</code></li><li><code>-Msize/alpha</code> (alpha&lt;0)</li><li><code>-Msize/alpha</code> (alpha&gt;0)</li></ol><p><code>-M</code> 选项多用于剖面图中，很少用于波形振幅图中，但本质上是没有区别的，故而在这里一并介绍。</p><h4 id="msize">-Msize</h4><p>size 的单位是英寸，这种用法会使得所有波形的最大振幅差在图上的长度为 size 英寸。其中，最大振幅差是指波形的最大振幅值与最小振幅值的差的绝对值，即 <code>abs(depmax-depmin)</code> 。</p><pre><code>pssac -JX6i/5i -R9/20/-2.5/2.5 -B1:&quot;T(s)&quot;:/0.5g0.5:&quot;Amplitude&quot;:WSen -M2 seis.? &gt; test.ps</code></pre><p>这个例子中， <code>-M2</code> 将所有波形做归一化使得最大振幅差对应的高度为 2 英寸。由于 Y 轴的范围是 <code>[-2.5, 2.5]</code>，Y 轴的高度为 5 英寸，即图上 1 个 Y 单位所对应的长度为 1 英寸，因而归一化之后最大振幅差对应 2 英寸，即 2 个 Y 单位，从图中也可以很明显的看出来。</p><div class="figure"> <img src="/images/2015071707.png"></div><p>这种做法使得所有波形在图上看上去最大振幅差都是 size 英寸，因而所有波形都失去了绝对振幅和相对振幅信息。以这个例子为例，图中读出的振幅值已经不再是波形真实的振幅值，即丢失了绝对振幅；另一方面，本例中绘制了 seis.1 和 seis.2 两个 SAC 文件，尽管两个 SAC 文件的振幅有两倍的差距，归一化之后相对振幅信息丢失，所以看上去两个波形完全重合了。</p><h4 id="alpha-小于-0">alpha 小于 0</h4><p>若 alpha&lt;0，则会根据第一个波形数据计算归一化因子，使得第一个波形的最大振幅差在图上等于 size 英寸，而其余的波形则会乘以同一个归一化因子。因而这种做法，所有波形虽然失去了绝对振幅信息，但却保留了相对振幅信息。</p><h4 id="alpha-大于-0">alpha 大于 0</h4><p>这种情况下，归一化因子为:</p><pre><code>yscale = pow(abs(h.dist), alpha)*size</code></pre><p>这样设计的原因是，对于一个正常的波形来说，震中距越大，由于几何扩散的效应，振幅越小。这个选项相当于对几何扩散项进行校正，即绘制了不考虑几何扩散情况下波形的相对振幅。</p><p>其中 alpha 是几何扩散因子，而 size 的含义不是太清晰。</p><h3 id="n-选项">-N 选项</h3><p><code>-Nclip</code> 选项会将绝对振幅超过 clip 的部分做截断。需要注意， <code>-N</code> 的优先级很低，因而 clip 值的选取要考虑其他选项对振幅的影响:</p><pre><code>pssac -JX6i/5i -R9/20/-2.5/2.5 -B1:&quot;T(s)&quot;:/0.5g0.5:&quot;Amplitude&quot;:WSen -M2 -N0.3 seis.1 &gt; test.ps</code></pre><p>本例中，对绝对振幅超过 0.3 的部分做截断。此处的 0.3 是经过归一化之后的振幅值，因而没有明确的物理含义。</p><div class="figure"> <img src="/images/2015071708.png"></div><h3 id="v-选项">-V 选项</h3><p><code>-V</code> 选项会交换 X 轴和 Y 轴，因而 <code>-J</code> 、 <code>-R</code> 和 <code>-B</code> 都需要做相应修改:</p><pre><code>pssac -JX5c/10c -R-2/2/9/20 -B1/2WSen seis.1 -V &gt; test.ps</code></pre><div class="figure"> <img src="/images/2015071709.png"></div><p>在某些特定的研究中会需要使用竖排模式。比如接收函数中，地震图中的某个震相到时可能与某个界面的深度成正比。通过将一系列波形竖排起来，纵坐标的时间对应某个特定的深度，因而可以很直观地看到界面深度的变化。</p><h3 id="w-和---g-选项">-W 和 - G 选项</h3><p><code>-W</code> 选项用于设置画笔数学，<code>-G</code> 选项用于控制波形的颜色填充:</p><pre><code>pssac -JX20c/10c -R9/20/-2/2 -B1:&quot;T(s)&quot;:/0.5:&quot;Amplitude&quot;:WSen -W0.2p,blue -G255/0/0/0 seis.1 &gt; test.ps</code></pre><p>本例中，线条宽度为 0.2p，颜色为蓝色，并对大于 0 的部分填充红色（ <code>255/0/0</code>）。</p><div class="figure"> <img src="/images/2015071710.png"></div><h2 id="剖面图">剖面图</h2><p>剖面图：横轴为时间，纵轴为其他物理量，pssac 中纵轴可以是震中距、方位角、反方位角以及文件序号。</p><p>pssac 使用 <code>-E</code> 选择来指定剖面图的具体性质，同时用 <code>-M</code> 选项对多个波形做归一化。其他的选项参考前面的说明。</p><h3 id="生成示例数据">生成示例数据</h3><p>先利用 SAC 自带的数据，生成绘制剖面图所需要的示例数据:</p><pre><code>SAC&gt; dg sub local cal.z cao.z cda.z cdv.z cmn.z cva.z cvl.z cvy.z
SAC&gt; rmean
SAC&gt; taper
SAC&gt; bp c 0.5 3
SAC&gt; w cal.z cao.z cda.z cdv.z cmn.z cva.z cvl.z cvy.z</code></pre><p>查看一下这些文件的基本头段信息：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ saclst b e a dist gcarc az baz f *.z</div><div class="line">cal.z      9.99365     50.0089     20.5949     12.4876    0.112316      234.02     53.9503</div><div class="line">cao.z      9.99365     50.0089     22.2028     23.0074    0.206933      144.09     324.182</div><div class="line">cda.z      9.99365     50.0089      23.078     23.9117    0.215068     350.813     170.787</div><div class="line">cdv.z      9.99365     50.0089     19.5975      5.4563   0.0490751     4.64117     184.644</div><div class="line">cmn.z      9.99365     50.0089     20.6763     12.3995    0.111524     350.452     170.437</div><div class="line">cva.z      9.99365     50.0089     20.7882     12.9964    0.116892     329.957     149.912</div><div class="line">cvl.z      9.99365     50.0089      21.867     17.9895    0.161802     312.309     132.218</div><div class="line">cvy.z      9.99365     50.0089     22.3656     18.8976     0.16997     318.278     138.192</div></pre></td></tr></table></figure><h3 id="波形振幅图-1">波形振幅图</h3><p>先用前面介绍过的方法，绘制一个波形振幅图。从数据的头段中可知，时间范围大概是 <code>[10, 50]</code> ，振幅的范围为 <code>[-500,500]</code> ，因而设置 - R 的范围为 <code>-R9/55/-500/500</code> :</p><pre><code>pssac -JX20c/10c -R9/55/-500/500 -B10/100WSen *.z &gt; test.ps</code></pre><p>此时，所有的波形共用 X 轴和 Y 轴，类似于 SAC 中 <code>plot2</code> 的绘图效果。</p><div class="figure"> <img src="/images/2015071711.png"></div><h3 id="最简单的剖面图">最简单的剖面图</h3><p><code>-E</code> 选项表明要绘制剖面图，其语法为 <code>-E(k|d|a|n|b)(t[n]|vel)</code>。语法中被小括号分开的两部分，分别用于指定剖面类型和时间轴对齐方式。</p><p>pssac 支持的剖面类型包括：</p><ul><li>a：Y 轴为方位角</li><li>b：Y 轴为反方位角</li><li>d：Y 轴为震中距（单位为度）</li><li>k：Y 轴为震中距（单位为千米）</li><li>n：Y 轴为波形的序号（从 1 到 N）</li></ul><p>不同的剖面类型，对应的 Y 轴的范围就不同。下面的例子展示了不同的剖面类型所使用的命令，注意其中 <code>-R</code> 和 <code>-B</code> 选项的差异:</p><pre><code>pssac -JX20c/10c -R10/50/3/28 -B10:&quot;T(s)&quot;:/5:&quot;Dist(km)&quot;:WSen -Ekt -M0.5 *.z &gt; test.ps
pssac -JX20c/10c -R10/50/-50/380 -B10:&quot;T(s)&quot;:/60:&quot;Azimuth&quot;:WSen -Eat -M0.5 *.z &gt; test.ps
pssac -JX20c/10c -R10/50/-50/380 -B10:&quot;T(s)&quot;:/60:&quot;Back Azimuth&quot;:WSen -Ebt -M0.5 *.z &gt; test.ps
pssac -JX20c/10c -R10/50/0/0.25 -B10:&quot;T(s)&quot;:/0.05:&quot;Dist(degree)&quot;:WSen -Edt -M0.5 *.z &gt; test.ps
pssac -JX20c/10c -R10/50/0/9 -B10:&quot;T(s)&quot;:/1:&quot;No.&quot;:WSen -Ent -M0.5 *.z &gt; test.ps</code></pre><p>这里只展示一下 <code>-Ek</code> 的结果，其他结果类似，此处 - M 的含义与之前介绍的相同。</p><div class="figure"> <img src="/images/2015071712.png"></div><p>时间轴对齐方式有三种（下面的例子中剖面类型都假定为 <code>k</code> ）：</p><ul><li><code>-Ekt</code> 表示按照绝对时间对齐</li><li><code>-Ektn</code> 表示按照某个头段对齐</li><li><code>-Ekvel</code> 表示按照给定的视速度对齐</li></ul><p>说明：</p><ol style="list-style-type:decimal"><li>n 可以取值为 - 5，-3，-2 以及 0 到 9<ul><li>-5 表示按照文件开始时间（b）对齐</li><li>-3 表示按发震时刻（o）对齐</li><li>-2 表示按初至到时对齐（a）对齐</li><li>0 到 9 表示按照 t0-t9 对齐</li><li>若 n 取数字，则等效于不指定 n，即 <code>-Ekt-8</code> 等效于 <code>-Ekt</code></li></ul></li><li>按照视速度对齐的代码是 <code>t -= fabs(h.dist)/reduce_vel</code></li></ol><p>下面的例子中展示了按照 b 值对齐，按照 a 值对齐，以及按照视速度 7 km/s 对齐的结果，注意其中 - R 选项的区别:</p><pre><code>pssac -JX20c/10c -R0/40/0/0.25 -B10:&quot;T(s)&quot;:/0.05:&quot;Dist(degree)&quot;:WSen -Edt-5 -M0.5 *.z &gt; test.ps
pssac -JX20c/10c -R-15/35/0/0.25 -B10:&quot;T(s)&quot;:/0.05:&quot;Dist(degree)&quot;:WSen -Edt-2 -M0.5 *.z &gt; test.ps
pssac -JX20c/10c -R10/50/0/0.25 -B10:&quot;T(s)&quot;:/0.05:&quot;Dist(degree)&quot;:WSen -Ed7 -M0.5 *.z &gt; test.ps</code></pre><p>这里只给出 <code>-Edt-2</code> 的绘图结果：</p><div class="figure"> <img src="/images/2015071713.png"></div><p><code>-Edt-2</code> 表示所有的波形要按照头段中的 a 值对齐，此时，波形中 a 所对应的数据点都位于 X 轴的 0 值处。因为数据中 a 大概在 20 秒左右，因而按照 a 值对齐之后，原波形的 X 轴范围 <code>[10,50]</code> 就变成了现在的 <code>[-10, 30]</code> 左右。</p><h3 id="c-选项">-C 选项</h3><p>由于 <code>-E</code> 的优先级高于 <code>-C</code> 的优先级，故而 - C 中的时间窗要根据对齐后的数据时间轴来选择:</p><pre><code>pssac -JX20c/10c -R-15/35/0/0.25 -B10:&quot;T(s)&quot;:/0.05:&quot;Dist(km)&quot;:WSen -Edt-2 -M0.5 -C-5/25 *.z &gt; a.ps</code></pre><p>如下图所示，对齐后的 X 轴范围是 - 15 到 35，此时的截窗范围为对齐后的 - 5 到 25 秒：</p><div class="figure"> <img src="/images/2015071714.png"></div><h2 id="任意位置图">任意位置图</h2><p>pssac 只支持 5 种剖面类型，有时候可能想要绘制其他量的剖面（比如慢度），或者想要在任意位置放置一个波形，或者想要不同波形有不同的画笔属性。这就需要用到 pssac 的另一个功能，即从标准输入中传递数据给 pssac。</p><p>要传递给 pssac 的数据有四列，格式为:</p><pre><code>sacfile X Y pen</code></pre><p>其中 <code>sacfile</code> 为 SAC 文件名，X 为波形起点时刻的 shift 量，Y 为波形在 Y 轴的位置，pen 为画笔属性。</p><pre><code>$ pssac -JX20c/10c -R10/70/0/15 -B10/5 -M1 &gt; a.ps &lt;&lt; EOF
cal.z 10 3 1p,black,-
cao.z 15 6 1p,red,-
cda.z 15 10 2p,black
EOF</code></pre><p>效果图如下：</p><div class="figure"> <img src="/images/2015071715.png"></div><p>注意：这一功能不能用于将波形画在地图上。对于地图而言，-R 指定的横轴为经度、纵轴是纬度，而 pssac 中 - R 指定的横轴是时间，纵轴是振幅。对于纵轴，可以使用 <code>-M</code> 选项对振幅进行任意比例的缩放，所以振幅和纬度之间的不一致性是可以消除的。而对于横轴而言，经度与时间的不一致性却很难消除。因而，想要用 pssac 将波形绘制在地图上，没有一个比较好的解决方案。但对于具体需求而言，是有可能使用某些 “黑科技” 来实现的，这将放在单独的博文中讨论。</p><h2 id="其他">其他</h2><p>这里会介绍算法中的一些细节。</p><h3 id="msize-归一化">-Msize 归一化</h3><p>振幅的归一化算法中实际上是将数据的振幅乘以比例因子 yscale，其中:</p><pre><code>yscale = size*fabs((north-south))/(h.depmax-h.depmin)/project_info.pars[1])</code></pre><p>其中，</p><ul><li><code>north</code> 和 <code>south</code> 为 - R 选项中指定的 Y 轴的最大值和最小值；</li><li><code>h.depmax</code> 和 <code>h.depmin</code> 为当前数据的振幅的最大值和最小值；</li><li><code>project_info.pars[1]</code> 是 - J 选项中当前投影的高度，单位为 inch；</li></ul><p>在这个例子中:</p><pre><code>pssac -JX6i/5i -R9/20/-2.5/2.5 -B1:&quot;T(s)&quot;:/0.5g0.5:&quot;Amplitude&quot;:WSen -M2 seis.1 &gt; test.ps</code></pre><ul><li><code>north=2.5 Y; south=-2.5 Y</code>（这里 Y 表示 Y 轴的单位，其物理意义可以是振幅，也可以是震中距等）</li><li><code>h.depmax=1.619187 Y; h.depmin=-1.470733 Y</code></li><li><code>project_info.pars[1] = 5 inch</code></li><li><code>size = 2 inch</code></li></ul><p>则波形的最大振幅差经过归一化之后为:</p><pre><code>(h.depmax-h.depmin) * yscale = size * abs(north-south)/project_info.pars[1]
                             = 2 inch * (2.5 Y - (-2.5 Y))/5 inch
                             = 2 Y</code></pre><p>即归一化之后的最大振幅差在图上的高度为 2 个 Y 单位。</p><h2 id="修订历史">修订历史</h2><ul><li>2013-08-08：初稿；</li><li>2015-07-17：将原稿的几篇合并并整理成一篇；</li><li>2016-03-16：解释了 <code>-E</code> 选项中 n 取其他值的含义；</li><li>2016-03-16：修复了图片 Y 轴标签的 bug；Thanks to <a href="mailto:gwx2013@USTC" target="_blank" rel="external">gwx2013@USTC</a>；</li></ul></div><footer class="post-footer"><div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button id="rewardButton" disable="enable" onclick='var e=document.getElementById("QR");"none"===e.style.display?e.style.display="block":e.style.display="none"'> <span>赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.png" alt="SeisMan WeChat Pay"><p>微信打赏</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/images/alipay.png" alt="SeisMan Alipay"><p>支付宝打赏</p></div></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/plot-traces-on-maps.html" rel="next" title="在地图上绘制波形"><i class="fa fa-chevron-left"></i> 在地图上绘制波形</a></div><div class="post-nav-prev post-nav-item"> <a href="/axes-without-ticks.html" rel="prev" title="GMT 绘制无刻度轴">GMT 绘制无刻度轴<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript> Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview"> 站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="SeisMan"><p class="site-author-name" itemprop="name">SeisMan</p><p class="site-description motion-element" itemprop="description">地球物理学在读博士</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">192</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories"><span class="site-state-item-count">8</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags"><span class="site-state-item-count">82</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/seisman" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://movie.douban.com/people/131919859/" target="_blank" title="豆瓣电影"><i class="fa fa-fw fa-film"></i> 豆瓣电影</a></span><span class="links-of-author-item"><a href="http://music.163.com/#/user/home?id=17736457" target="_blank" title="网易云音乐"><i class="fa fa-fw fa-music"></i> 网易云音乐</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-globe"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://seispider.top/" title="SeisPider" target="_blank">SeisPider</a></li><li class="links-of-blogroll-item"> <a href="http://blog.wangliang.one/" title="王亮的博客" target="_blank">王亮的博客</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#选项一览"><span class="nav-number">1.</span> <span class="nav-text">选项一览</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#gmt-标准选项"><span class="nav-number">1.1.</span> <span class="nav-text">GMT 标准选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pssac-特有选项"><span class="nav-number">1.2.</span> <span class="nav-text">pssac 特有选项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#波形振幅图"><span class="nav-number">2.</span> <span class="nav-text">波形振幅图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#示例-sac-数据"><span class="nav-number">2.1.</span> <span class="nav-text">示例 SAC 数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#单个波形的振幅"><span class="nav-number">2.2.</span> <span class="nav-text">单个波形的振幅</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#绘制多个波形"><span class="nav-number">2.3.</span> <span class="nav-text">绘制多个波形</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#s-选项的效果"><span class="nav-number">2.4.</span> <span class="nav-text">-S 选项的效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-选项的效果"><span class="nav-number">2.5.</span> <span class="nav-text">-C 选项的效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#i--q--r"><span class="nav-number">2.6.</span> <span class="nav-text">-I, -Q, -r</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#m-选项"><span class="nav-number">2.7.</span> <span class="nav-text">-M 选项</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#msize"><span class="nav-number">2.7.1.</span> <span class="nav-text">-Msize</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#alpha-小于-0"><span class="nav-number">2.7.2.</span> <span class="nav-text">alpha 小于 0</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#alpha-大于-0"><span class="nav-number">2.7.3.</span> <span class="nav-text">alpha 大于 0</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#n-选项"><span class="nav-number">2.8.</span> <span class="nav-text">-N 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#v-选项"><span class="nav-number">2.9.</span> <span class="nav-text">-V 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#w-和---g-选项"><span class="nav-number">2.10.</span> <span class="nav-text">-W 和 - G 选项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#剖面图"><span class="nav-number">3.</span> <span class="nav-text">剖面图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#生成示例数据"><span class="nav-number">3.1.</span> <span class="nav-text">生成示例数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#波形振幅图-1"><span class="nav-number">3.2.</span> <span class="nav-text">波形振幅图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#最简单的剖面图"><span class="nav-number">3.3.</span> <span class="nav-text">最简单的剖面图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-选项"><span class="nav-number">3.4.</span> <span class="nav-text">-C 选项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#任意位置图"><span class="nav-number">4.</span> <span class="nav-text">任意位置图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他"><span class="nav-number">5.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#msize-归一化"><span class="nav-number">5.1.</span> <span class="nav-text">-Msize 归一化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修订历史"><span class="nav-number">6.</span> <span class="nav-text">修订历史</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2013 - <span itemprop="copyrightYear">2017</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">SeisMan</span></div><div class="powered-by"> 由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info"> 主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script><script type="text/javascript">function run_disqus_script(s){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/"+s,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}var disqus_shortname="seisman",disqus_identifier="pssac-notes.html",disqus_title="pssac 使用教程",disqus_url="http://seisman.info/pssac-notes.html";run_disqus_script("count.js"),run_disqus_script("embed.js")</script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="popoverlay">').css("overflow","hidden"),$(".popup").toggle()}var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path,searchFunc=function(e,t,a){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var r=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),c=document.getElementById(t),s=document.getElementById(a);c.addEventListener("input",function(){var e=0,t='<ul class="search-result-list">',a=this.value.trim().toLowerCase().split(/[\s\-]+/);s.innerHTML="",this.value.trim().length>1&&r.forEach(function(r){var c=!0,s=r.title.trim().toLowerCase(),n=r.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),o=r.url,i=-1,l=-1,p=-1;if(""!=s&&""!=n&&a.forEach(function(e,t){i=s.indexOf(e),l=n.indexOf(e),i<0&&l<0?c=!1:(l<0&&(l=0),0==t&&(p=l))}),c){e+=1,t+="<li><a href='"+o+"' class='search-result-title'>"+s+"</a>";var h=r.content.trim().replace(/<[^>]+>/g,"");if(p>=0){var u=p-20,d=p+80;u<0&&(u=0),0==u&&(d=50),d>h.length&&(d=h.length);var f=h.substring(u,d);a.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,'<b class="search-keyword">'+e+"</b>")}),t+='<p class="search-result">'+f+"...</p>"}t+="</li>"}}),t+="</ul>",0==e&&(t='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==a&&(t='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),s.innerHTML=t}),proceedsearch()}})};$(".popup-trigger").mousedown(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".popoverlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script></body></html>